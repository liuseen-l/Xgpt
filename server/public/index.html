<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div> <button id="btn" style="width: 100%;height: 50px;">同意授权</button></div>
    <div> <button style="width: 100%;height: 50px;margin-top: 20px;">拒绝授权</button></div>
    <script>
        const btn = document.getElementById('btn')
        let createTime = location.search.slice(1).split('=')[1]

        const fpPromise = import('https://openfpcdn.io/fingerprintjs/v4')
            .then(FingerprintJS => FingerprintJS.load())


        // 拿到浏览器id,生成设备id,登陆时一起传过去
        btn.onclick = () => {
            fpPromise
                .then(fp => fp.get())
                .then(result => {
                    const did = result.visitorId
                    //点击授权按钮
                    fetch(`http://124.71.110.30:8080/user/login/by/scan?&did=${did}&createTime=${createTime}`, {
                        method: 'Get',
                    }).then(res => res.json()).then(res => {
                        alert(`授权成功`)
                    }).catch(err => {
                        alert(err)
                    })
                })


        }
    </script>
</body>

</html>